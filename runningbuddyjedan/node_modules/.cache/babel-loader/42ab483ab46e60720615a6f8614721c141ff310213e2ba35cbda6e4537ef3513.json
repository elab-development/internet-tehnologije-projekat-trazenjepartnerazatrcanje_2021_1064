{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP_Elitebook\\\\internet-tehnologije-projekat-trazenjepartnerazatrcanje_2021_1064\\\\runningbuddyjedan\\\\src\\\\components\\\\Itinerary.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { jwtDecode } from 'jwt-decode';\nimport axios from 'axios';\nimport PlanCard from '../components/PlanCard';\nimport { usePlansContext } from '../hooks/PlansHooks';\nimport { useItineraryContext } from '../hooks/ItineraryHooks';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Itinerary = ({\n  user\n}) => {\n  _s();\n  const token = sessionStorage.getItem('token');\n  const decodedToken = jwtDecode(token);\n  const userId = decodedToken.userId;\n  const {\n    dispatch: plansDispatch\n  } = usePlansContext();\n  const {\n    itinerary,\n    dispatch: itineraryDispatch\n  } = useItineraryContext();\n\n  // itinerer korisnika koji je ulogovan\n  useEffect(() => {\n    if (token) {\n      const fetchItinerary = async () => {\n        try {\n          const response = await axios.get(`http://localhost:4000/api/user/${userId}`, {\n            headers: {\n              authorization: token\n            }\n          });\n          itineraryDispatch({\n            type: 'SET_ITINERARY',\n            payload: response.data.Itinerary.plans\n          });\n        } catch (error) {\n          console.error('Failed to fetch itinerary:', error);\n        }\n      };\n      fetchItinerary();\n    }\n  }, [token, userId, itineraryDispatch]);\n\n  // brisanje plana\n  const handleDelete = async planId => {\n    try {\n      const response = await fetch(`http://localhost:4000/api/plan/${planId}`, {\n        method: 'DELETE',\n        headers: {\n          authorization: token\n        }\n      });\n      const json = await response.json();\n      if (response.ok) {\n        itineraryDispatch({\n          type: 'REMOVE_PLAN_FROM_ITINERARY',\n          payload: json.plan\n        });\n      }\n    } catch (error) {\n      console.error('Failed to delete plan:', error);\n    }\n  };\n\n  // brisanje tudjeg plana iz itinerera\n  const handleRemove = async planId => {\n    try {\n      const response = await fetch('http://localhost:4000/api/itinerary/delete', {\n        method: 'DELETE',\n        body: JSON.stringify({\n          planId\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          authorization: token\n        }\n      });\n      const json = await response.json();\n      console.log(json);\n      if (response.ok) {\n        plansDispatch({\n          type: 'ADD_PLAN',\n          payload: json.plan\n        });\n        itineraryDispatch({\n          type: 'REMOVE_PLAN_FROM_ITINERARY',\n          payload: json.plan\n        });\n      }\n    } catch (error) {\n      console.error('Failed to remove plan:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col md:flex-row p-6 \",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 md:mr-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: user && itinerary.length > 0 ? itinerary.map(plan => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-green-50 p-4 rounded-lg flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(PlanCard, {\n              plan: plan\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: new Date() < new Date(plan.time) && (plan.creatorId === userId ? /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleDelete(plan.id),\n                className: \"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500\",\n                children: \"Delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 7\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleRemove(plan.id),\n                className: \"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-500\",\n                children: \"Remove\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 94,\n                columnNumber: 7\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 19\n            }, this)]\n          }, plan.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 17\n          }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700\",\n            children: \"No plans in your itinerary.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(Itinerary, \"LQ20/T5bGfucjTHmk/mZ7sLbmU8=\", false, function () {\n  return [usePlansContext, useItineraryContext];\n});\n_c = Itinerary;\nexport default Itinerary;\nvar _c;\n$RefreshReg$(_c, \"Itinerary\");","map":{"version":3,"names":["React","useEffect","jwtDecode","axios","PlanCard","usePlansContext","useItineraryContext","jsxDEV","_jsxDEV","Fragment","_Fragment","Itinerary","user","_s","token","sessionStorage","getItem","decodedToken","userId","dispatch","plansDispatch","itinerary","itineraryDispatch","fetchItinerary","response","get","headers","authorization","type","payload","data","plans","error","console","handleDelete","planId","fetch","method","json","ok","plan","handleRemove","body","JSON","stringify","log","children","className","length","map","fileName","_jsxFileName","lineNumber","columnNumber","Date","time","creatorId","onClick","id","_c","$RefreshReg$"],"sources":["C:/Users/HP_Elitebook/internet-tehnologije-projekat-trazenjepartnerazatrcanje_2021_1064/runningbuddyjedan/src/components/Itinerary.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { jwtDecode } from 'jwt-decode';\r\nimport axios from 'axios';\r\nimport PlanCard from '../components/PlanCard'; \r\nimport { usePlansContext } from '../hooks/PlansHooks';\r\nimport { useItineraryContext } from '../hooks/ItineraryHooks';\r\n\r\nconst Itinerary = ({ user }) => {\r\n  const token = sessionStorage.getItem('token');\r\n  const decodedToken = jwtDecode(token);\r\n  const userId = decodedToken.userId;\r\n  const { dispatch: plansDispatch } = usePlansContext();\r\n  const { itinerary, dispatch: itineraryDispatch } = useItineraryContext();\r\n\r\n  // itinerer korisnika koji je ulogovan\r\n  useEffect(() => {\r\n    if (token) {\r\n      const fetchItinerary = async () => {\r\n        try {\r\n          const response = await axios.get(`http://localhost:4000/api/user/${userId}`, {\r\n            headers: { authorization: token }\r\n          });\r\n          itineraryDispatch({ type: 'SET_ITINERARY', payload: response.data.Itinerary.plans });\r\n        } catch (error) {\r\n          console.error('Failed to fetch itinerary:', error);\r\n        }\r\n      };\r\n\r\n      fetchItinerary();\r\n    }\r\n  }, [token, userId, itineraryDispatch]);\r\n\r\n  // brisanje plana\r\n  const handleDelete = async (planId) => {\r\n    try {\r\n      const response = await fetch(`http://localhost:4000/api/plan/${planId}`, {\r\n        method: 'DELETE',\r\n        headers: { authorization: token },\r\n      });\r\n      const json = await response.json();\r\n      if (response.ok) {\r\n        itineraryDispatch({ type: 'REMOVE_PLAN_FROM_ITINERARY', payload: json.plan });\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to delete plan:', error);\r\n    }\r\n  };\r\n\r\n  // brisanje tudjeg plana iz itinerera\r\n  const handleRemove = async (planId) => {\r\n    try {\r\n      const response = await fetch('http://localhost:4000/api/itinerary/delete', {\r\n        method: 'DELETE',\r\n        body: JSON.stringify({ planId }),\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          authorization: token,\r\n        },\r\n      });\r\n      const json = await response.json();\r\n      console.log(json)\r\n      if (response.ok) {\r\n        plansDispatch({ type: 'ADD_PLAN', payload: json.plan });\r\n\r\n        itineraryDispatch({ type: 'REMOVE_PLAN_FROM_ITINERARY', payload: json.plan });\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to remove plan:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex flex-col md:flex-row p-6 \">\r\n        <div className=\"flex-1 md:mr-4\">\r\n          <div className=\"space-y-4\">\r\n            {user && itinerary.length > 0 ? (\r\n              itinerary.map((plan) => (\r\n                <div\r\n                  key={plan.id}\r\n                  className=\"bg-green-50 p-4 rounded-lg flex items-center justify-between\"\r\n                >\r\n                  <PlanCard plan={plan} />\r\n                  <div className=\"flex items-center space-x-2\">{\r\n  new Date() < new Date(plan.time) && (\r\n    plan.creatorId === userId ? (\r\n      <button\r\n        onClick={() => handleDelete(plan.id)}\r\n        className=\"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500\"\r\n      >\r\n        Delete\r\n      </button>\r\n    ) : (\r\n      <button\r\n        onClick={() => handleRemove(plan.id)}\r\n        className=\"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-500\"\r\n      >\r\n        Remove\r\n      </button>\r\n    )\r\n  )\r\n}\r\n                    \r\n                  </div>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p className=\"text-gray-700\">No plans in your itinerary.</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        \r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Itinerary;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,QAAQ,MAAM,wBAAwB;AAC7C,SAASC,eAAe,QAAQ,qBAAqB;AACrD,SAASC,mBAAmB,QAAQ,yBAAyB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE9D,MAAMC,SAAS,GAAGA,CAAC;EAAEC;AAAK,CAAC,KAAK;EAAAC,EAAA;EAC9B,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;EAC7C,MAAMC,YAAY,GAAGf,SAAS,CAACY,KAAK,CAAC;EACrC,MAAMI,MAAM,GAAGD,YAAY,CAACC,MAAM;EAClC,MAAM;IAAEC,QAAQ,EAAEC;EAAc,CAAC,GAAGf,eAAe,CAAC,CAAC;EACrD,MAAM;IAAEgB,SAAS;IAAEF,QAAQ,EAAEG;EAAkB,CAAC,GAAGhB,mBAAmB,CAAC,CAAC;;EAExE;EACAL,SAAS,CAAC,MAAM;IACd,IAAIa,KAAK,EAAE;MACT,MAAMS,cAAc,GAAG,MAAAA,CAAA,KAAY;QACjC,IAAI;UACF,MAAMC,QAAQ,GAAG,MAAMrB,KAAK,CAACsB,GAAG,CAAC,kCAAkCP,MAAM,EAAE,EAAE;YAC3EQ,OAAO,EAAE;cAAEC,aAAa,EAAEb;YAAM;UAClC,CAAC,CAAC;UACFQ,iBAAiB,CAAC;YAAEM,IAAI,EAAE,eAAe;YAAEC,OAAO,EAAEL,QAAQ,CAACM,IAAI,CAACnB,SAAS,CAACoB;UAAM,CAAC,CAAC;QACtF,CAAC,CAAC,OAAOC,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QACpD;MACF,CAAC;MAEDT,cAAc,CAAC,CAAC;IAClB;EACF,CAAC,EAAE,CAACT,KAAK,EAAEI,MAAM,EAAEI,iBAAiB,CAAC,CAAC;;EAEtC;EACA,MAAMY,YAAY,GAAG,MAAOC,MAAM,IAAK;IACrC,IAAI;MACF,MAAMX,QAAQ,GAAG,MAAMY,KAAK,CAAC,kCAAkCD,MAAM,EAAE,EAAE;QACvEE,MAAM,EAAE,QAAQ;QAChBX,OAAO,EAAE;UAAEC,aAAa,EAAEb;QAAM;MAClC,CAAC,CAAC;MACF,MAAMwB,IAAI,GAAG,MAAMd,QAAQ,CAACc,IAAI,CAAC,CAAC;MAClC,IAAId,QAAQ,CAACe,EAAE,EAAE;QACfjB,iBAAiB,CAAC;UAAEM,IAAI,EAAE,4BAA4B;UAAEC,OAAO,EAAES,IAAI,CAACE;QAAK,CAAC,CAAC;MAC/E;IACF,CAAC,CAAC,OAAOR,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAChD;EACF,CAAC;;EAED;EACA,MAAMS,YAAY,GAAG,MAAON,MAAM,IAAK;IACrC,IAAI;MACF,MAAMX,QAAQ,GAAG,MAAMY,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,QAAQ;QAChBK,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAET;QAAO,CAAC,CAAC;QAChCT,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAEb;QACjB;MACF,CAAC,CAAC;MACF,MAAMwB,IAAI,GAAG,MAAMd,QAAQ,CAACc,IAAI,CAAC,CAAC;MAClCL,OAAO,CAACY,GAAG,CAACP,IAAI,CAAC;MACjB,IAAId,QAAQ,CAACe,EAAE,EAAE;QACfnB,aAAa,CAAC;UAAEQ,IAAI,EAAE,UAAU;UAAEC,OAAO,EAAES,IAAI,CAACE;QAAK,CAAC,CAAC;QAEvDlB,iBAAiB,CAAC;UAAEM,IAAI,EAAE,4BAA4B;UAAEC,OAAO,EAAES,IAAI,CAACE;QAAK,CAAC,CAAC;MAC/E;IACF,CAAC,CAAC,OAAOR,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAChD;EACF,CAAC;EAED,oBACExB,OAAA,CAAAE,SAAA;IAAAoC,QAAA,eACEtC,OAAA;MAAKuC,SAAS,EAAC,gCAAgC;MAAAD,QAAA,eAC7CtC,OAAA;QAAKuC,SAAS,EAAC,gBAAgB;QAAAD,QAAA,eAC7BtC,OAAA;UAAKuC,SAAS,EAAC,WAAW;UAAAD,QAAA,EACvBlC,IAAI,IAAIS,SAAS,CAAC2B,MAAM,GAAG,CAAC,GAC3B3B,SAAS,CAAC4B,GAAG,CAAET,IAAI,iBACjBhC,OAAA;YAEEuC,SAAS,EAAC,8DAA8D;YAAAD,QAAA,gBAExEtC,OAAA,CAACJ,QAAQ;cAACoC,IAAI,EAAEA;YAAK;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACxB7C,OAAA;cAAKuC,SAAS,EAAC,6BAA6B;cAAAD,QAAA,EAC5D,IAAIQ,IAAI,CAAC,CAAC,GAAG,IAAIA,IAAI,CAACd,IAAI,CAACe,IAAI,CAAC,KAC9Bf,IAAI,CAACgB,SAAS,KAAKtC,MAAM,gBACvBV,OAAA;gBACEiD,OAAO,EAAEA,CAAA,KAAMvB,YAAY,CAACM,IAAI,CAACkB,EAAE,CAAE;gBACrCX,SAAS,EAAC,6GAA6G;gBAAAD,QAAA,EACxH;cAED;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,gBAET7C,OAAA;gBACEiD,OAAO,EAAEA,CAAA,KAAMhB,YAAY,CAACD,IAAI,CAACkB,EAAE,CAAE;gBACrCX,SAAS,EAAC,sHAAsH;gBAAAD,QAAA,EACjI;cAED;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CACT;YACF;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAGoB,CAAC;UAAA,GAxBDb,IAAI,CAACkB,EAAE;YAAAR,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAyBT,CACN,CAAC,gBAEF7C,OAAA;YAAGuC,SAAS,EAAC,eAAe;YAAAD,QAAA,EAAC;UAA2B;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG;QAC5D;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAGH;EAAC,gBACN,CAAC;AAEP,CAAC;AAACxC,EAAA,CA7GIF,SAAS;EAAA,QAIuBN,eAAe,EACAC,mBAAmB;AAAA;AAAAqD,EAAA,GALlEhD,SAAS;AA+Gf,eAAeA,SAAS;AAAC,IAAAgD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}